(()=>{"use strict";class e{constructor(e,t,o){this.projectName=e,this.todo_list=t,this.selected=!1}}const t=(()=>{let t=JSON.parse(localStorage.getItem("task.projects"))||[];function o(e){localStorage.setItem("task.projects",JSON.stringify(e))}return{makeProject:function(c,n){let r=new e(c,n);t.push(r),console.log({projectList:t}),o(t)},changeName:function(e,c){t[c].projectName=e,o(t)},removeProject:function(e){t.splice(e,1),o(t)},select:function(e,c){t[e].selected=c,o(t)},saveProject:o,projectList:t}})();class o{constructor(e,t,o,c,n){this.todoName=e,this.description=t,this.date=o,this.priority=c,this.completed=!1}}const c=(()=>{let e=[];return{isSelected:function(){let e=t.projectList;for(let t=0;t<e.length;t++)if(!0===e[t].selected)return t},makeTodo:function(t,c,n,r){let d=new o(t,c,n,r);return e.push(d),d},sortList:function(e){let t=[];for(let o=0;o<e.length;o++)"High"===e[o].priority&&t.push(e[o]);for(let o=0;o<e.length;o++)"Medium"===e[o].priority&&t.push(e[o]);for(let o=0;o<e.length;o++)"Low"===e[o].priority&&t.push(e[o]);return t}}})(),n=(()=>{function e(){const e=document.querySelector(".modal"),t=document.querySelector(".modal-overlay");e.classList.toggle("closed"),t.classList.toggle("closed")}function o(){document.querySelector("#todo-btn").classList.add("closed")}function n(){const o=document.querySelector("#todo-name"),n=document.querySelector("#todo-description"),r=document.querySelector("#todo-date"),l=document.querySelector("#priority");!function(){const e=document.querySelector("#todo-name"),o=document.querySelector("#todo-description"),n=document.querySelector("#todo-date").value,r=document.querySelector("#priority");let l=c.makeTodo(e.value,o.value,n,r.value),i=c.isSelected();t.projectList[i].todo_list.push(l),t.projectList[i].todo_list=c.sortList(t.projectList[i].todo_list),t.saveProject(t.projectList),console.log(t.projectList[i]),d()}(),o.value="",n.value="",r.value="",l.value="Low",e()}const r=document.querySelector("#modal-form");function d(){let e=c.isSelected(),o=t.projectList[e];const n=document.querySelector("#content"),r=document.createElement("h1");r.setAttribute("id","content-title"),n.appendChild(r),l();const d=t.projectList[c.isSelected()].projectName;r.textContent=d,n.appendChild(r),console.log(o.todo_list);for(let e=0;e<o.todo_list.length;e++)i(o.todo_list[e],e),console.log("test2")}function l(){const e=document.querySelector("#content"),t=document.querySelector("#content-title"),o=document.querySelectorAll(".todo-container");for(let t=0;t<o.length;t++)e.removeChild(o[t]);e.removeChild(t)}function i(o,i){const s=document.querySelector("#content"),a=document.createElement("h1"),u=document.createElement("div"),p=document.createElement("input"),m=document.createElement("label"),v=document.createElement("span"),h=document.createElement("div"),L=document.createElement("div"),y=document.createElement("h3"),j=document.createElement("div"),f=document.createElement("input"),S=document.createElement("div"),g=document.createElement("button"),E=document.createElement("button"),C=t.projectList[c.isSelected()].projectName;a.textContent=C,y.textContent=o.todoName,j.textContent=o.description,f.setAttribute("type","date"),f.value=o.date,f.classList.add("todo-date-div"),p.setAttribute("type","checkbox"),g.textContent="E",E.textContent="X",L.classList.add("todo-text"),u.classList.add("todo-container"),p.classList.add("custom-checkbox"),g.classList.add("btn"),E.classList.add("btn"),h.classList.add("left-container"),g.addEventListener("click",(()=>{!function(o){let i=t.projectList[c.isSelected()].todo_list;const s=document.querySelector("#todo-name"),a=document.querySelector("#todo-description"),u=document.querySelector("#todo-date"),p=document.querySelector("#priority");s.value=i[o].todoName,a.value=i[o].description,u.value=i[o].date,p.value=i[o].priority,e(),r.removeEventListener("submit",n),r.addEventListener("submit",(function m(){i[o].todoName=s.value,i[o].description=a.value,i[o].date=u.value,i[o].priority=p.value;let v=c.isSelected();t.projectList[v].todo_list=c.sortList(t.projectList[v].todo_list),l(),d(),e(),s.value="",a.value="",u.value="",p.value="Low",t.saveProject(t.projectList),this.removeEventListener("submit",m),r.addEventListener("submit",n)}))}(i)})),E.addEventListener("click",(()=>{console.log(i),function(e){t.projectList[c.isSelected()].todo_list.splice(e,1),t.saveProject(t.projectList),d()}(i)})),f.addEventListener("change",(()=>{o.date=f.value,t.saveProject(t.projectList)})),p.addEventListener("click",(()=>{o.completed=p.checked,t.saveProject(t.projectList)})),p.checked=o.completed,"High"===o.priority&&(v.style.cssText="border-color: red; --checkColor: red"),"Medium"===o.priority&&(v.style.cssText="border-color: orange; --checkColor: orange"),"Low"===o.priority&&(v.style.cssText="border-color: green; --checkColor: green"),m.appendChild(p),m.appendChild(v),v.classList.add("custom-checkbox"),L.appendChild(y),L.appendChild(j),h.appendChild(m),h.appendChild(L),S.appendChild(f),S.appendChild(g),S.appendChild(E),u.appendChild(h),u.appendChild(S),s.appendChild(u)}return r.addEventListener("submit",(e=>{e.preventDefault()})),r.addEventListener("submit",n),{addTodoButton:function(){if(void 0!==c.isSelected()){const t=document.querySelector("#todo-btn");t.classList.remove("closed"),document.querySelector("#modal-exit").addEventListener("click",e),t.addEventListener("click",e)}else o()},removeTodoButton:o,displayTodo:d}})(),r=(()=>{const e=document.querySelector("#projects-container");function o(o,n){const d=document.createElement("div"),i=document.createElement("div"),s=document.createElement("button"),a=document.createElement("button");d.classList.add("project"),i.classList.add("project-title"),s.classList.add("btn"),a.classList.add("btn"),s.textContent="E",a.textContent="X",i.addEventListener("click",(e=>{e.stopPropagation(),l(),t.select(n,!0),r()})),s.addEventListener("click",(e=>{e.stopPropagation(),function(e){const o=document.querySelectorAll(".project"),c=document.querySelectorAll(".project-title"),n=document.createElement("input");n.classList.add("edit-text"),n.setAttribute("type","text"),n.setAttribute("maxlength","10"),n.value=t.projectList[e].projectName,o[e].removeChild(c[e]),o[e].appendChild(n),n.addEventListener("keypress",(o=>{"Enter"===o.key&&(console.log("yes"),t.changeName(n.value,e),r())}))}(n)})),a.addEventListener("click",(o=>{o.stopPropagation(),function(o){const n=document.querySelectorAll(".project");e.removeChild(n[o]),t.removeProject(o),r(),console.log(c.isSelected())}(n)})),i.textContent=o,d.appendChild(i),d.appendChild(s),d.appendChild(a),e.appendChild(d)}function r(){!function(){for(;e.firstChild;)e.removeChild(e.firstChild)}();let c=0,r=t.projectList;for(console.log(r);c<r.length;c++)o(r[c].projectName,c),!0===r[c].selected&&(d(c),n.addTodoButton(),n.displayTodo())}function d(e){l(),t.select(e,!0),document.querySelectorAll(".project-title")[e].style.cssText="font-weight: bold"}function l(){for(let e=0;e<t.projectList.length;e++)t.select(e,!1)}return document.querySelector("#add-project").addEventListener("submit",(e=>{e.preventDefault();const o=document.querySelector(".project-name");var c;c=o.value,t.makeProject(c,[]),r(),o.value=""})),{addProject:o,render:r}})();console.log("test"),r.render()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iZXR0ZXItdG9kby1saXN0Ly4vc3JjL3Byb2plY3QtbG9naWMuanMiLCJ3ZWJwYWNrOi8vYmV0dGVyLXRvZG8tbGlzdC8uL3NyYy90b2RvLWxvZ2ljLmpzIiwid2VicGFjazovL2JldHRlci10b2RvLWxpc3QvLi9zcmMvdG9kby1kb20uanMiLCJ3ZWJwYWNrOi8vYmV0dGVyLXRvZG8tbGlzdC8uL3NyYy9wcm9qZWN0LWRvbS5qcyIsIndlYnBhY2s6Ly9iZXR0ZXItdG9kby1saXN0Ly4vc3JjL3Rlc3QuanMiLCJ3ZWJwYWNrOi8vYmV0dGVyLXRvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJwcm9qZWN0TmFtZSIsInRvZG9fbGlzdCIsInNlbGVjdGVkIiwidGhpcyIsInByb2plY3RMaXN0IiwiSlNPTiIsInBhcnNlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInNhdmVQcm9qZWN0IiwicHJvamVjdCIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJtYWtlUHJvamVjdCIsIm9iaiIsInB1c2giLCJjb25zb2xlIiwibG9nIiwiY2hhbmdlTmFtZSIsIm5ld05hbWUiLCJpbmRleCIsInJlbW92ZVByb2plY3QiLCJzcGxpY2UiLCJzZWxlY3QiLCJib29sIiwiVG9kbyIsInRvZG9OYW1lIiwiZGVzY3JpcHRpb24iLCJkYXRlIiwicHJpb3JpdHkiLCJjb21wbGV0ZWQiLCJ0b2RvTGlzdCIsImlzU2VsZWN0ZWQiLCJsaXN0IiwiaSIsImxlbmd0aCIsIm1ha2VUb2RvIiwic29ydExpc3QiLCJuZXdMaXN0IiwidG9nZ2xlTW9kYWwiLCJtb2RhbCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm1vZGFsT3ZlcmxheSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZVRvZG9CdXR0b24iLCJhZGQiLCJtb2RhbEZsb3ciLCJ0b2RvRGVzY3JpcHRpb24iLCJ0b2RvRGF0ZSIsInRvZG9Qcmlvcml0eSIsInZhbHVlIiwidG9kbyIsImRpc3BsYXlUb2RvIiwiZm9ybVN1Ym1pdCIsIm1vZGFsRm9ybSIsImNvbnRlbnQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJjbGVhclRvZG8iLCJwcm9qZWN0VGl0bGUiLCJ0ZXh0Q29udGVudCIsIm1ha2VUb2RvVGFnIiwidG9kb0NvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJyZW1vdmVDaGlsZCIsImNoZWNrIiwiY2hlY2tMYWJlbCIsImNoZWNrU3BhbiIsImxlZnRDb250YWluZXIiLCJ0b2RvVGV4dCIsInJpZ2h0Q29udGFpbmVyIiwiZWRpdCIsImRlbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidG9kb0VkaXRGb3JtIiwiZWRpdFRvZG8iLCJkZWxldGVUb2RvIiwiY2hlY2tlZCIsInN0eWxlIiwiY3NzVGV4dCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImFkZFRvZG9CdXR0b24iLCJ1bmRlZmluZWQiLCJ0b2RvQnV0dG9uIiwicmVtb3ZlIiwicHJvamVjdENvbnRhaW5lciIsImFkZFByb2plY3QiLCJpbnB1dE5hbWUiLCJzdG9wUHJvcGFnYXRpb24iLCJkZXNlbGVjdFByb2plY3QiLCJyZW5kZXIiLCJlZGl0VGV4dCIsImtleSIsImVkaXRQcm9qZWN0IiwiZGVsZXRlUHJvamVjdCIsImZpcnN0Q2hpbGQiLCJjbGVhclByb2plY3QiLCJzZWxlY3RQcm9qZWN0IiwicHJvamVjdFRleHQiXSwibWFwcGluZ3MiOiJtQkFBQSxNQUFNQSxFQUNMQyxZQUFZQyxFQUFhQyxFQUFXQyxHQUNuQ0MsS0FBS0gsWUFBY0EsRUFDbkJHLEtBQUtGLFVBQVlBLEVBQ2pCRSxLQUFLRCxVQUFXLEdBSWxCLE1BdUNBLEVBdkNxQixNQUNwQixJQUFJRSxFQUFjQyxLQUFLQyxNQUFNQyxhQUFhQyxRQUFRLG1CQUFxQixHQUV2RSxTQUFTQyxFQUFZQyxHQUNwQkgsYUFBYUksUUFBUSxnQkFBaUJOLEtBQUtPLFVBQVVGLElBeUJ0RCxNQUFPLENBQ05HLFlBdkJELFNBQXFCYixFQUFhQyxHQUNqQyxJQUFJYSxFQUFNLElBQUloQixFQUFRRSxFQUFhQyxHQUNuQ0csRUFBWVcsS0FBS0QsR0FDakJFLFFBQVFDLElBQUksQ0FBRWIsZ0JBQ2RLLEVBQVlMLElBb0JaYyxXQVpELFNBQW9CQyxFQUFTQyxHQUM1QmhCLEVBQVlnQixHQUFPcEIsWUFBY21CLEVBQ2pDVixFQUFZTCxJQVdaaUIsY0FsQkQsU0FBdUJELEdBQ3RCaEIsRUFBWWtCLE9BQU9GLEVBQU8sR0FDMUJYLEVBQVlMLElBaUJabUIsT0FURCxTQUFnQkgsRUFBT0ksR0FDdEJwQixFQUFZZ0IsR0FBT2xCLFNBQVdzQixFQUM5QmYsRUFBWUwsSUFRWkssY0FDQUwsZ0JBbkNtQixHQ05yQixNQUFNcUIsRUFDTDFCLFlBQVkyQixFQUFVQyxFQUFhQyxFQUFNQyxFQUFVQyxHQUNsRDNCLEtBQUt1QixTQUFXQSxFQUNoQnZCLEtBQUt3QixZQUFjQSxFQUNuQnhCLEtBQUt5QixLQUFPQSxFQUNaekIsS0FBSzBCLFNBQVdBLEVBQ2hCMUIsS0FBSzJCLFdBQVksR0FJbkIsTUF3Q0EsRUF4Q2tCLE1BQ2pCLElBQUlDLEVBQVcsR0FvQ2YsTUFBTyxDQUFFQyxXQVBULFdBQ0MsSUFBSUMsRUFBTyxjQUNYLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJRCxFQUFLRSxPQUFRRCxJQUNoQyxJQUF5QixJQUFyQkQsRUFBS0MsR0FBR2hDLFNBQW1CLE9BQU9nQyxHQUluQkUsU0FsQ3JCLFNBQWtCVixFQUFVQyxFQUFhQyxFQUFNQyxHQUM5QyxJQUFJZixFQUFNLElBQUlXLEVBQUtDLEVBQVVDLEVBQWFDLEVBQU1DLEdBRWhELE9BREFFLEVBQVNoQixLQUFLRCxHQUNQQSxHQStCdUJ1QixTQTVCL0IsU0FBa0JKLEdBQ2pCLElBQUlLLEVBQVUsR0FDZCxJQUFLLElBQUlKLEVBQUksRUFBR0EsRUFBSUQsRUFBS0UsT0FBUUQsSUFDUCxTQUFyQkQsRUFBS0MsR0FBR0wsVUFDWFMsRUFBUXZCLEtBQUtrQixFQUFLQyxJQUdwQixJQUFLLElBQUlBLEVBQUksRUFBR0EsRUFBSUQsRUFBS0UsT0FBUUQsSUFDUCxXQUFyQkQsRUFBS0MsR0FBR0wsVUFDWFMsRUFBUXZCLEtBQUtrQixFQUFLQyxJQUdwQixJQUFLLElBQUlBLEVBQUksRUFBR0EsRUFBSUQsRUFBS0UsT0FBUUQsSUFDUCxRQUFyQkQsRUFBS0MsR0FBR0wsVUFDWFMsRUFBUXZCLEtBQUtrQixFQUFLQyxJQUlwQixPQUFPSSxLQTNCUyxHQzZObEIsRUF0T2dCLE1BYWYsU0FBU0MsSUFDUixNQUFNQyxFQUFRQyxTQUFTQyxjQUFjLFVBQy9CQyxFQUFlRixTQUFTQyxjQUFjLGtCQUU1Q0YsRUFBTUksVUFBVUMsT0FBTyxVQUN2QkYsRUFBYUMsVUFBVUMsT0FBTyxVQUcvQixTQUFTQyxJQUNXTCxTQUFTQyxjQUFjLGFBQy9CRSxVQUFVRyxJQUFJLFVBRzFCLFNBQVNDLElBQ1IsTUFBTXRCLEVBQVdlLFNBQVNDLGNBQWMsY0FDbENPLEVBQWtCUixTQUFTQyxjQUFjLHFCQUN6Q1EsRUFBV1QsU0FBU0MsY0FBYyxjQUNsQ1MsRUFBZVYsU0FBU0MsY0FBYyxjQWU3QyxXQUNDLE1BQU1oQixFQUFXZSxTQUFTQyxjQUFjLGNBQ2xDTyxFQUFrQlIsU0FBU0MsY0FBYyxxQkFDekNRLEVBQVdULFNBQVNDLGNBQWMsY0FBY1UsTUFDaERELEVBQWVWLFNBQVNDLGNBQWMsYUFFNUMsSUFBSVcsRUFBTyxXQUNWM0IsRUFBUzBCLE1BQ1RILEVBQWdCRyxNQUNoQkYsRUFDQUMsRUFBYUMsT0FHVmhDLEVBQVEsZUFDWixjQUF5QkEsR0FBT25CLFVBQVVjLEtBQUtzQyxHQUMvQyxjQUF5QmpDLEdBQU9uQixVQUFZLFdBQzNDLGNBQXlCbUIsR0FBT25CLFdBRWpDLGNBQXlCLGVBQ3pCZSxRQUFRQyxJQUFJLGNBQXlCRyxJQUNyQ2tDLElBbENBQyxHQUNBN0IsRUFBUzBCLE1BQVEsR0FDakJILEVBQWdCRyxNQUFRLEdBQ3hCRixFQUFTRSxNQUFRLEdBQ2pCRCxFQUFhQyxNQUFRLE1BQ3JCYixJQUdELE1BQU1pQixFQUFZZixTQUFTQyxjQUFjLGVBNkJ6QyxTQUFTWSxJQUNSLElBQUlsQyxFQUFRLGVBQ1JhLEVBQU8sY0FBeUJiLEdBQ3BDLE1BQU1xQyxFQUFVaEIsU0FBU0MsY0FBYyxZQUNqQzFDLEVBQWN5QyxTQUFTaUIsY0FBYyxNQUMzQzFELEVBQVkyRCxhQUFhLEtBQU0saUJBQy9CRixFQUFRRyxZQUFZNUQsR0FDcEI2RCxJQUNBLE1BQU1DLEVBQ0wsY0FBeUIsZ0JBQXdCOUQsWUFDbERBLEVBQVkrRCxZQUFjRCxFQUMxQkwsRUFBUUcsWUFBWTVELEdBQ3BCZ0IsUUFBUUMsSUFBSWdCLEVBQUtoQyxXQUNqQixJQUFLLElBQUlpQyxFQUFJLEVBQUdBLEVBQUlELEVBQUtoQyxVQUFVa0MsT0FBUUQsSUFDMUM4QixFQUFZL0IsRUFBS2hDLFVBQVVpQyxHQUFJQSxHQUMvQmxCLFFBQVFDLElBQUksU0FJZCxTQUFTNEMsSUFDUixNQUFNSixFQUFVaEIsU0FBU0MsY0FBYyxZQUNqQ29CLEVBQWVyQixTQUFTQyxjQUFjLGtCQUN0Q3VCLEVBQWdCeEIsU0FBU3lCLGlCQUFpQixtQkFDaEQsSUFBSyxJQUFJaEMsRUFBSSxFQUFHQSxFQUFJK0IsRUFBYzlCLE9BQVFELElBQ3pDdUIsRUFBUVUsWUFBWUYsRUFBYy9CLElBRW5DdUIsRUFBUVUsWUFBWUwsR0FPckIsU0FBU0UsRUFBWWxELEVBQUtvQixHQUN6QixNQUFNdUIsRUFBVWhCLFNBQVNDLGNBQWMsWUFDakMxQyxFQUFjeUMsU0FBU2lCLGNBQWMsTUFDckNPLEVBQWdCeEIsU0FBU2lCLGNBQWMsT0FDdkNVLEVBQVEzQixTQUFTaUIsY0FBYyxTQUMvQlcsRUFBYTVCLFNBQVNpQixjQUFjLFNBQ3BDWSxFQUFZN0IsU0FBU2lCLGNBQWMsUUFDbkNhLEVBQWdCOUIsU0FBU2lCLGNBQWMsT0FDdkNjLEVBQVcvQixTQUFTaUIsY0FBYyxPQUNsQ2hDLEVBQVdlLFNBQVNpQixjQUFjLE1BQ2xDVCxFQUFrQlIsU0FBU2lCLGNBQWMsT0FDekNSLEVBQVdULFNBQVNpQixjQUFjLFNBQ2xDZSxFQUFpQmhDLFNBQVNpQixjQUFjLE9BQ3hDZ0IsRUFBT2pDLFNBQVNpQixjQUFjLFVBQzlCaUIsRUFBTWxDLFNBQVNpQixjQUFjLFVBRTdCSSxFQUNMLGNBQXlCLGdCQUF3QjlELFlBQ2xEQSxFQUFZK0QsWUFBY0QsRUFFMUJwQyxFQUFTcUMsWUFBY2pELEVBQUlZLFNBQzNCdUIsRUFBZ0JjLFlBQWNqRCxFQUFJYSxZQUNsQ3VCLEVBQVNTLGFBQWEsT0FBUSxRQUM5QlQsRUFBU0UsTUFBUXRDLEVBQUljLEtBQ3JCc0IsRUFBU04sVUFBVUcsSUFBSSxpQkFDdkJxQixFQUFNVCxhQUFhLE9BQVEsWUFDM0JlLEVBQUtYLFlBQWMsSUFDbkJZLEVBQUlaLFlBQWMsSUFFbEJTLEVBQVM1QixVQUFVRyxJQUFJLGFBQ3ZCa0IsRUFBY3JCLFVBQVVHLElBQUksa0JBQzVCcUIsRUFBTXhCLFVBQVVHLElBQUksbUJBQ3BCMkIsRUFBSzlCLFVBQVVHLElBQUksT0FDbkI0QixFQUFJL0IsVUFBVUcsSUFBSSxPQUNsQndCLEVBQWMzQixVQUFVRyxJQUFJLGtCQUU1QjJCLEVBQUtFLGlCQUFpQixTQUFTLE1BOENoQyxTQUFrQjFDLEdBQ2pCLElBQUlELEVBQU8sY0FBeUIsZ0JBQXdCaEMsVUFDNUQsTUFBTXlCLEVBQVdlLFNBQVNDLGNBQWMsY0FDbENPLEVBQWtCUixTQUFTQyxjQUFjLHFCQUN6Q1EsRUFBV1QsU0FBU0MsY0FBYyxjQUNsQ1MsRUFBZVYsU0FBU0MsY0FBYyxhQUU1Q2hCLEVBQVMwQixNQUFRbkIsRUFBS0MsR0FBR1IsU0FDekJ1QixFQUFnQkcsTUFBUW5CLEVBQUtDLEdBQUdQLFlBQ2hDdUIsRUFBU0UsTUFBUW5CLEVBQUtDLEdBQUdOLEtBQ3pCdUIsRUFBYUMsTUFBUW5CLEVBQUtDLEdBQUdMLFNBQzdCVSxJQUVBaUIsRUFBVXFCLG9CQUFvQixTQUFVN0IsR0FFeENRLEVBQVVvQixpQkFBaUIsVUFBVSxTQUFTRSxJQUM3QzdDLEVBQUtDLEdBQUdSLFNBQVdBLEVBQVMwQixNQUM1Qm5CLEVBQUtDLEdBQUdQLFlBQWNzQixFQUFnQkcsTUFDdENuQixFQUFLQyxHQUFHTixLQUFPc0IsRUFBU0UsTUFDeEJuQixFQUFLQyxHQUFHTCxTQUFXc0IsRUFBYUMsTUFDaEMsSUFBSWhDLEVBQVEsZUFDWixjQUF5QkEsR0FBT25CLFVBQVksV0FDM0MsY0FBeUJtQixHQUFPbkIsV0FFakM0RCxJQUNBUCxJQUNBZixJQUNBYixFQUFTMEIsTUFBUSxHQUNqQkgsRUFBZ0JHLE1BQVEsR0FDeEJGLEVBQVNFLE1BQVEsR0FDakJELEVBQWFDLE1BQVEsTUFDckIsY0FBeUIsZUFDekJqRCxLQUFLMEUsb0JBQW9CLFNBQVVDLEdBQ25DdEIsRUFBVW9CLGlCQUFpQixTQUFVNUIsTUE5RXJDK0IsQ0FBUzdDLE1BR1Z5QyxFQUFJQyxpQkFBaUIsU0FBUyxLQUM3QjVELFFBQVFDLElBQUlpQixHQThFZCxTQUFvQkEsR0FDUixjQUF5QixnQkFBd0JqQyxVQUN2RHFCLE9BQU9ZLEVBQUcsR0FDZixjQUF5QixlQUN6Qm9CLElBakZDMEIsQ0FBVzlDLE1BR1pnQixFQUFTMEIsaUJBQWlCLFVBQVUsS0FDbkM5RCxFQUFJYyxLQUFPc0IsRUFBU0UsTUFDcEIsY0FBeUIsa0JBRzFCZ0IsRUFBTVEsaUJBQWlCLFNBQVMsS0FDL0I5RCxFQUFJZ0IsVUFBWXNDLEVBQU1hLFFBQ3RCLGNBQXlCLGtCQUcxQmIsRUFBTWEsUUFBVW5FLEVBQUlnQixVQUVDLFNBQWpCaEIsRUFBSWUsV0FDUHlDLEVBQVVZLE1BQU1DLFFBQVUsd0NBQ04sV0FBakJyRSxFQUFJZSxXQUNQeUMsRUFBVVksTUFBTUMsUUFBVSw4Q0FDTixRQUFqQnJFLEVBQUllLFdBQ1B5QyxFQUFVWSxNQUFNQyxRQUFVLDRDQUUzQmQsRUFBV1QsWUFBWVEsR0FDdkJDLEVBQVdULFlBQVlVLEdBQ3ZCQSxFQUFVMUIsVUFBVUcsSUFBSSxtQkFDeEJ5QixFQUFTWixZQUFZbEMsR0FDckI4QyxFQUFTWixZQUFZWCxHQUNyQnNCLEVBQWNYLFlBQVlTLEdBQzFCRSxFQUFjWCxZQUFZWSxHQUMxQkMsRUFBZWIsWUFBWVYsR0FDM0J1QixFQUFlYixZQUFZYyxHQUMzQkQsRUFBZWIsWUFBWWUsR0FFM0JWLEVBQWNMLFlBQVlXLEdBRTFCTixFQUFjTCxZQUFZYSxHQUUxQmhCLEVBQVFHLFlBQVlLLEdBK0NyQixPQTNMQVQsRUFBVW9CLGlCQUFpQixVQUFXUSxJQUNyQ0EsRUFBRUMsb0JBRUg3QixFQUFVb0IsaUJBQWlCLFNBQVU1QixHQXdMOUIsQ0FBRXNDLGNBbE9ULFdBQ0MsUUFBK0JDLElBQTNCLGVBQXNDLENBQ3pDLE1BQU1DLEVBQWEvQyxTQUFTQyxjQUFjLGFBQzFDOEMsRUFBVzVDLFVBQVU2QyxPQUFPLFVBRVZoRCxTQUFTQyxjQUFjLGVBRS9Ca0MsaUJBQWlCLFFBQVNyQyxHQUNwQ2lELEVBQVdaLGlCQUFpQixRQUFTckMsUUFDL0JPLEtBeU5nQkEsbUJBQWtCUSxnQkFuTzNCLEdDd0hoQixFQXZIbUIsTUFDbEIsTUFBTW9DLEVBQW1CakQsU0FBU0MsY0FBYyx1QkFXaEQsU0FBU2lELEVBQVdDLEVBQVcxRCxHQUM5QixNQUFNeEIsRUFBVStCLFNBQVNpQixjQUFjLE9BQ2pDMUQsRUFBY3lDLFNBQVNpQixjQUFjLE9BQ3JDZ0IsRUFBT2pDLFNBQVNpQixjQUFjLFVBQzlCaUIsRUFBTWxDLFNBQVNpQixjQUFjLFVBRW5DaEQsRUFBUWtDLFVBQVVHLElBQUksV0FDdEIvQyxFQUFZNEMsVUFBVUcsSUFBSSxpQkFDMUIyQixFQUFLOUIsVUFBVUcsSUFBSSxPQUNuQjRCLEVBQUkvQixVQUFVRyxJQUFJLE9BQ2xCMkIsRUFBS1gsWUFBYyxJQUNuQlksRUFBSVosWUFBYyxJQUVsQi9ELEVBQVk0RSxpQkFBaUIsU0FBVVEsSUFDdENBLEVBQUVTLGtCQUNGQyxJQUNBLFNBQW9CNUQsR0FBRyxHQUN2QjZELE9BR0RyQixFQUFLRSxpQkFBaUIsU0FBVVEsSUFDL0JBLEVBQUVTLGtCQW1ESixTQUFxQjNELEdBQ3BCLE1BQU14QixFQUFVK0IsU0FBU3lCLGlCQUFpQixZQUNwQ0osRUFBZXJCLFNBQVN5QixpQkFBaUIsa0JBQ3pDOEIsRUFBV3ZELFNBQVNpQixjQUFjLFNBQ3hDc0MsRUFBU3BELFVBQVVHLElBQUksYUFDdkJpRCxFQUFTckMsYUFBYSxPQUFRLFFBQzlCcUMsRUFBU3JDLGFBQWEsWUFBYSxNQUNuQ3FDLEVBQVM1QyxNQUFRLGNBQXlCbEIsR0FBR2xDLFlBQzdDVSxFQUFRd0IsR0FBR2lDLFlBQVlMLEVBQWE1QixJQUNwQ3hCLEVBQVF3QixHQUFHMEIsWUFBWW9DLEdBQ3ZCQSxFQUFTcEIsaUJBQWlCLFlBQWFRLElBQ3hCLFVBQVZBLEVBQUVhLE1BQ0xqRixRQUFRQyxJQUFJLE9BQ1osYUFBd0IrRSxFQUFTNUMsTUFBT2xCLEdBQ3hDNkQsUUFoRURHLENBQVloRSxNQUdieUMsRUFBSUMsaUJBQWlCLFNBQVVRLElBQzlCQSxFQUFFUyxrQkFzQ0osU0FBdUIzRCxHQUN0QixNQUFNeEIsRUFBVStCLFNBQVN5QixpQkFBaUIsWUFDMUN3QixFQUFpQnZCLFlBQVl6RCxFQUFRd0IsSUFDckMsZ0JBQTJCQSxHQUMzQjZELElBQ0EvRSxRQUFRQyxJQUFJLGdCQTFDWGtGLENBQWNqRSxNQUdmbEMsRUFBWStELFlBQWM2QixFQUUxQmxGLEVBQVFrRCxZQUFZNUQsR0FDcEJVLEVBQVFrRCxZQUFZYyxHQUNwQmhFLEVBQVFrRCxZQUFZZSxHQUVwQmUsRUFBaUI5QixZQUFZbEQsR0FHOUIsU0FBU3FGLEtBZVQsV0FDQyxLQUFPTCxFQUFpQlUsWUFDdkJWLEVBQWlCdkIsWUFBWXVCLEVBQWlCVSxZQWhCL0NDLEdBQ0EsSUFBSW5FLEVBQUksRUFDSkQsRUFBTyxjQUVYLElBREFqQixRQUFRQyxJQUFJZ0IsR0FDSkMsRUFBSUQsRUFBS0UsT0FBUUQsSUFDeEJ5RCxFQUFXMUQsRUFBS0MsR0FBR2xDLFlBQWFrQyxJQUNQLElBQXJCRCxFQUFLQyxHQUFHaEMsV0FDWG9HLEVBQWNwRSxHQUNkLGtCQUNBLGlCQTBDSCxTQUFTb0UsRUFBY3BFLEdBQ3RCNEQsSUFDQSxTQUFvQjVELEdBQUcsR0FDRk8sU0FBU3lCLGlCQUFpQixrQkFDbENoQyxHQUFHZ0QsTUFBTUMsUUFBVSxvQkFHakMsU0FBU1csSUFDUixJQUFLLElBQUk1RCxFQUFJLEVBQUdBLEVBQUkscUJBQWlDQSxJQUNwRCxTQUFvQkEsR0FBRyxHQUl6QixPQWxIb0JPLFNBQVNDLGNBQWMsZ0JBRS9Ca0MsaUJBQWlCLFVBQVdRLElBQ3ZDQSxFQUFFQyxpQkFDRixNQUFNa0IsRUFBYzlELFNBQVNDLGNBQWMsaUJBa0U1QyxJQUEyQjFDLElBakVSdUcsRUFBWW5ELE1Ba0U5QixjQUF5QnBELEVBQWEsSUFqRXRDK0YsSUFDQVEsRUFBWW5ELE1BQVEsTUEyR2QsQ0FBRXVDLGFBQVlJLFdBcEhILEdDSGxCL0UsUUFBUUMsSUFBSSxRQ0tiLFkiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFByb2plY3Qge1xuXHRjb25zdHJ1Y3Rvcihwcm9qZWN0TmFtZSwgdG9kb19saXN0LCBzZWxlY3RlZCkge1xuXHRcdHRoaXMucHJvamVjdE5hbWUgPSBwcm9qZWN0TmFtZTtcblx0XHR0aGlzLnRvZG9fbGlzdCA9IHRvZG9fbGlzdDtcblx0XHR0aGlzLnNlbGVjdGVkID0gZmFsc2U7XG5cdH1cbn1cblxuY29uc3QgcHJvamVjdExvZ2ljID0gKCgpID0+IHtcblx0bGV0IHByb2plY3RMaXN0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInRhc2sucHJvamVjdHNcIikpIHx8IFtdO1xuXG5cdGZ1bmN0aW9uIHNhdmVQcm9qZWN0KHByb2plY3QpIHtcblx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInRhc2sucHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkocHJvamVjdCkpO1xuXHR9XG5cblx0ZnVuY3Rpb24gbWFrZVByb2plY3QocHJvamVjdE5hbWUsIHRvZG9fbGlzdCkge1xuXHRcdGxldCBvYmogPSBuZXcgUHJvamVjdChwcm9qZWN0TmFtZSwgdG9kb19saXN0KTtcblx0XHRwcm9qZWN0TGlzdC5wdXNoKG9iaik7XG5cdFx0Y29uc29sZS5sb2coeyBwcm9qZWN0TGlzdCB9KTtcblx0XHRzYXZlUHJvamVjdChwcm9qZWN0TGlzdCk7XG5cdH1cblxuXHRmdW5jdGlvbiByZW1vdmVQcm9qZWN0KGluZGV4KSB7XG5cdFx0cHJvamVjdExpc3Quc3BsaWNlKGluZGV4LCAxKTtcblx0XHRzYXZlUHJvamVjdChwcm9qZWN0TGlzdCk7XG5cdH1cblxuXHRmdW5jdGlvbiBjaGFuZ2VOYW1lKG5ld05hbWUsIGluZGV4KSB7XG5cdFx0cHJvamVjdExpc3RbaW5kZXhdLnByb2plY3ROYW1lID0gbmV3TmFtZTtcblx0XHRzYXZlUHJvamVjdChwcm9qZWN0TGlzdCk7XG5cdH1cblxuXHRmdW5jdGlvbiBzZWxlY3QoaW5kZXgsIGJvb2wpIHtcblx0XHRwcm9qZWN0TGlzdFtpbmRleF0uc2VsZWN0ZWQgPSBib29sO1xuXHRcdHNhdmVQcm9qZWN0KHByb2plY3RMaXN0KTtcblx0fVxuXG5cdHJldHVybiB7XG5cdFx0bWFrZVByb2plY3QsXG5cdFx0Y2hhbmdlTmFtZSxcblx0XHRyZW1vdmVQcm9qZWN0LFxuXHRcdHNlbGVjdCxcblx0XHRzYXZlUHJvamVjdCxcblx0XHRwcm9qZWN0TGlzdCxcblx0fTtcbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IHByb2plY3RMb2dpYztcbiIsImltcG9ydCBwcm9qZWN0TG9naWMgZnJvbSBcIi4vcHJvamVjdC1sb2dpYy5qc1wiO1xuXG5jbGFzcyBUb2RvIHtcblx0Y29uc3RydWN0b3IodG9kb05hbWUsIGRlc2NyaXB0aW9uLCBkYXRlLCBwcmlvcml0eSwgY29tcGxldGVkKSB7XG5cdFx0dGhpcy50b2RvTmFtZSA9IHRvZG9OYW1lO1xuXHRcdHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcblx0XHR0aGlzLmRhdGUgPSBkYXRlO1xuXHRcdHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcblx0XHR0aGlzLmNvbXBsZXRlZCA9IGZhbHNlO1xuXHR9XG59XG5cbmNvbnN0IHRvZG9Mb2dpYyA9ICgoKSA9PiB7XG5cdGxldCB0b2RvTGlzdCA9IFtdO1xuXG5cdGZ1bmN0aW9uIG1ha2VUb2RvKHRvZG9OYW1lLCBkZXNjcmlwdGlvbiwgZGF0ZSwgcHJpb3JpdHkpIHtcblx0XHRsZXQgb2JqID0gbmV3IFRvZG8odG9kb05hbWUsIGRlc2NyaXB0aW9uLCBkYXRlLCBwcmlvcml0eSk7XG5cdFx0dG9kb0xpc3QucHVzaChvYmopO1xuXHRcdHJldHVybiBvYmo7XG5cdH1cblxuXHRmdW5jdGlvbiBzb3J0TGlzdChsaXN0KSB7XG5cdFx0bGV0IG5ld0xpc3QgPSBbXTtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmIChsaXN0W2ldLnByaW9yaXR5ID09PSBcIkhpZ2hcIikge1xuXHRcdFx0XHRuZXdMaXN0LnB1c2gobGlzdFtpXSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYgKGxpc3RbaV0ucHJpb3JpdHkgPT09IFwiTWVkaXVtXCIpIHtcblx0XHRcdFx0bmV3TGlzdC5wdXNoKGxpc3RbaV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmIChsaXN0W2ldLnByaW9yaXR5ID09PSBcIkxvd1wiKSB7XG5cdFx0XHRcdG5ld0xpc3QucHVzaChsaXN0W2ldKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbmV3TGlzdDtcblx0fVxuXG5cdGZ1bmN0aW9uIGlzU2VsZWN0ZWQoKSB7XG5cdFx0bGV0IGxpc3QgPSBwcm9qZWN0TG9naWMucHJvamVjdExpc3Q7XG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAobGlzdFtpXS5zZWxlY3RlZCA9PT0gdHJ1ZSkgcmV0dXJuIGk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHsgaXNTZWxlY3RlZCwgbWFrZVRvZG8sIHNvcnRMaXN0IH07XG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCB0b2RvTG9naWM7XG4iLCJpbXBvcnQgcHJvamVjdExvZ2ljIGZyb20gXCIuL3Byb2plY3QtbG9naWMuanNcIjtcbmltcG9ydCB0b2RvTG9naWMgZnJvbSBcIi4vdG9kby1sb2dpYy5qc1wiO1xuXG5jb25zdCB0b2RvRE9NID0gKCgpID0+IHtcblx0ZnVuY3Rpb24gYWRkVG9kb0J1dHRvbigpIHtcblx0XHRpZiAodG9kb0xvZ2ljLmlzU2VsZWN0ZWQoKSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRjb25zdCB0b2RvQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvLWJ0blwiKTtcblx0XHRcdHRvZG9CdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNsb3NlZFwiKTtcblxuXHRcdFx0Y29uc3QgbW9kYWxFeGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1leGl0XCIpO1xuXG5cdFx0XHRtb2RhbEV4aXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRvZ2dsZU1vZGFsKTtcblx0XHRcdHRvZG9CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRvZ2dsZU1vZGFsKTtcblx0XHR9IGVsc2UgcmVtb3ZlVG9kb0J1dHRvbigpO1xuXHR9XG5cblx0ZnVuY3Rpb24gdG9nZ2xlTW9kYWwoKSB7XG5cdFx0Y29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsXCIpO1xuXHRcdGNvbnN0IG1vZGFsT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtb3ZlcmxheVwiKTtcblxuXHRcdG1vZGFsLmNsYXNzTGlzdC50b2dnbGUoXCJjbG9zZWRcIik7XG5cdFx0bW9kYWxPdmVybGF5LmNsYXNzTGlzdC50b2dnbGUoXCJjbG9zZWRcIik7XG5cdH1cblxuXHRmdW5jdGlvbiByZW1vdmVUb2RvQnV0dG9uKCkge1xuXHRcdGNvbnN0IHRvZG9CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3RvZG8tYnRuXCIpO1xuXHRcdHRvZG9CdXR0b24uY2xhc3NMaXN0LmFkZChcImNsb3NlZFwiKTtcblx0fVxuXG5cdGZ1bmN0aW9uIG1vZGFsRmxvdygpIHtcblx0XHRjb25zdCB0b2RvTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG9kby1uYW1lXCIpO1xuXHRcdGNvbnN0IHRvZG9EZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG9kby1kZXNjcmlwdGlvblwiKTtcblx0XHRjb25zdCB0b2RvRGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG9kby1kYXRlXCIpO1xuXHRcdGNvbnN0IHRvZG9Qcmlvcml0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJpb3JpdHlcIik7XG5cdFx0Zm9ybVN1Ym1pdCgpO1xuXHRcdHRvZG9OYW1lLnZhbHVlID0gXCJcIjtcblx0XHR0b2RvRGVzY3JpcHRpb24udmFsdWUgPSBcIlwiO1xuXHRcdHRvZG9EYXRlLnZhbHVlID0gXCJcIjtcblx0XHR0b2RvUHJpb3JpdHkudmFsdWUgPSBcIkxvd1wiO1xuXHRcdHRvZ2dsZU1vZGFsKCk7XG5cdH1cblxuXHRjb25zdCBtb2RhbEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWZvcm1cIik7XG5cdG1vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHR9KTtcblx0bW9kYWxGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgbW9kYWxGbG93KTtcblxuXHRmdW5jdGlvbiBmb3JtU3VibWl0KCkge1xuXHRcdGNvbnN0IHRvZG9OYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvLW5hbWVcIik7XG5cdFx0Y29uc3QgdG9kb0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvLWRlc2NyaXB0aW9uXCIpO1xuXHRcdGNvbnN0IHRvZG9EYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvLWRhdGVcIikudmFsdWU7XG5cdFx0Y29uc3QgdG9kb1ByaW9yaXR5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmlvcml0eVwiKTtcblxuXHRcdGxldCB0b2RvID0gdG9kb0xvZ2ljLm1ha2VUb2RvKFxuXHRcdFx0dG9kb05hbWUudmFsdWUsXG5cdFx0XHR0b2RvRGVzY3JpcHRpb24udmFsdWUsXG5cdFx0XHR0b2RvRGF0ZSxcblx0XHRcdHRvZG9Qcmlvcml0eS52YWx1ZVxuXHRcdCk7XG5cblx0XHRsZXQgaW5kZXggPSB0b2RvTG9naWMuaXNTZWxlY3RlZCgpO1xuXHRcdHByb2plY3RMb2dpYy5wcm9qZWN0TGlzdFtpbmRleF0udG9kb19saXN0LnB1c2godG9kbyk7XG5cdFx0cHJvamVjdExvZ2ljLnByb2plY3RMaXN0W2luZGV4XS50b2RvX2xpc3QgPSB0b2RvTG9naWMuc29ydExpc3QoXG5cdFx0XHRwcm9qZWN0TG9naWMucHJvamVjdExpc3RbaW5kZXhdLnRvZG9fbGlzdFxuXHRcdCk7XG5cdFx0cHJvamVjdExvZ2ljLnNhdmVQcm9qZWN0KHByb2plY3RMb2dpYy5wcm9qZWN0TGlzdCk7XG5cdFx0Y29uc29sZS5sb2cocHJvamVjdExvZ2ljLnByb2plY3RMaXN0W2luZGV4XSk7XG5cdFx0ZGlzcGxheVRvZG8oKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGRpc3BsYXlUb2RvKCkge1xuXHRcdGxldCBpbmRleCA9IHRvZG9Mb2dpYy5pc1NlbGVjdGVkKCk7XG5cdFx0bGV0IGxpc3QgPSBwcm9qZWN0TG9naWMucHJvamVjdExpc3RbaW5kZXhdO1xuXHRcdGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NvbnRlbnRcIik7XG5cdFx0Y29uc3QgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XG5cdFx0cHJvamVjdE5hbWUuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJjb250ZW50LXRpdGxlXCIpO1xuXHRcdGNvbnRlbnQuYXBwZW5kQ2hpbGQocHJvamVjdE5hbWUpO1xuXHRcdGNsZWFyVG9kbygpO1xuXHRcdGNvbnN0IHByb2plY3RUaXRsZSA9XG5cdFx0XHRwcm9qZWN0TG9naWMucHJvamVjdExpc3RbdG9kb0xvZ2ljLmlzU2VsZWN0ZWQoKV0ucHJvamVjdE5hbWU7XG5cdFx0cHJvamVjdE5hbWUudGV4dENvbnRlbnQgPSBwcm9qZWN0VGl0bGU7XG5cdFx0Y29udGVudC5hcHBlbmRDaGlsZChwcm9qZWN0TmFtZSk7XG5cdFx0Y29uc29sZS5sb2cobGlzdC50b2RvX2xpc3QpO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC50b2RvX2xpc3QubGVuZ3RoOyBpKyspIHtcblx0XHRcdG1ha2VUb2RvVGFnKGxpc3QudG9kb19saXN0W2ldLCBpKTtcblx0XHRcdGNvbnNvbGUubG9nKFwidGVzdDJcIik7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gY2xlYXJUb2RvKCkge1xuXHRcdGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NvbnRlbnRcIik7XG5cdFx0Y29uc3QgcHJvamVjdFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb250ZW50LXRpdGxlXCIpO1xuXHRcdGNvbnN0IHRvZG9Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRvZG8tY29udGFpbmVyXCIpO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdG9kb0NvbnRhaW5lci5sZW5ndGg7IGkrKykge1xuXHRcdFx0Y29udGVudC5yZW1vdmVDaGlsZCh0b2RvQ29udGFpbmVyW2ldKTtcblx0XHR9XG5cdFx0Y29udGVudC5yZW1vdmVDaGlsZChwcm9qZWN0VGl0bGUpO1xuXG5cdFx0Ly8gd2hpbGUgKGNvbnRlbnQuZmlyc3RDaGlsZCkge1xuXHRcdC8vIFx0Y29udGVudC5yZW1vdmVDaGlsZChjb250ZW50LmZpcnN0Q2hpbGQpO1xuXHRcdC8vIH1cblx0fVxuXG5cdGZ1bmN0aW9uIG1ha2VUb2RvVGFnKG9iaiwgaSkge1xuXHRcdGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NvbnRlbnRcIik7XG5cdFx0Y29uc3QgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XG5cdFx0Y29uc3QgdG9kb0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0Y29uc3QgY2hlY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG5cdFx0Y29uc3QgY2hlY2tMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcblx0XHRjb25zdCBjaGVja1NwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHRjb25zdCBsZWZ0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRjb25zdCB0b2RvVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0Y29uc3QgdG9kb05hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDNcIik7XG5cdFx0Y29uc3QgdG9kb0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRjb25zdCB0b2RvRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcblx0XHRjb25zdCByaWdodENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0Y29uc3QgZWRpdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cdFx0Y29uc3QgZGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcblxuXHRcdGNvbnN0IHByb2plY3RUaXRsZSA9XG5cdFx0XHRwcm9qZWN0TG9naWMucHJvamVjdExpc3RbdG9kb0xvZ2ljLmlzU2VsZWN0ZWQoKV0ucHJvamVjdE5hbWU7XG5cdFx0cHJvamVjdE5hbWUudGV4dENvbnRlbnQgPSBwcm9qZWN0VGl0bGU7XG5cblx0XHR0b2RvTmFtZS50ZXh0Q29udGVudCA9IG9iai50b2RvTmFtZTtcblx0XHR0b2RvRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBvYmouZGVzY3JpcHRpb247XG5cdFx0dG9kb0RhdGUuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImRhdGVcIik7XG5cdFx0dG9kb0RhdGUudmFsdWUgPSBvYmouZGF0ZTtcblx0XHR0b2RvRGF0ZS5jbGFzc0xpc3QuYWRkKFwidG9kby1kYXRlLWRpdlwiKTtcblx0XHRjaGVjay5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiY2hlY2tib3hcIik7XG5cdFx0ZWRpdC50ZXh0Q29udGVudCA9IFwiRVwiO1xuXHRcdGRlbC50ZXh0Q29udGVudCA9IFwiWFwiO1xuXG5cdFx0dG9kb1RleHQuY2xhc3NMaXN0LmFkZChcInRvZG8tdGV4dFwiKTtcblx0XHR0b2RvQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWNvbnRhaW5lclwiKTtcblx0XHRjaGVjay5jbGFzc0xpc3QuYWRkKFwiY3VzdG9tLWNoZWNrYm94XCIpO1xuXHRcdGVkaXQuY2xhc3NMaXN0LmFkZChcImJ0blwiKTtcblx0XHRkZWwuY2xhc3NMaXN0LmFkZChcImJ0blwiKTtcblx0XHRsZWZ0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJsZWZ0LWNvbnRhaW5lclwiKTtcblxuXHRcdGVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblx0XHRcdGVkaXRUb2RvKGkpO1xuXHRcdH0pO1xuXG5cdFx0ZGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZyhpKTtcblx0XHRcdGRlbGV0ZVRvZG8oaSk7XG5cdFx0fSk7XG5cblx0XHR0b2RvRGF0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcblx0XHRcdG9iai5kYXRlID0gdG9kb0RhdGUudmFsdWU7XG5cdFx0XHRwcm9qZWN0TG9naWMuc2F2ZVByb2plY3QocHJvamVjdExvZ2ljLnByb2plY3RMaXN0KTtcblx0XHR9KTtcblxuXHRcdGNoZWNrLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHRvYmouY29tcGxldGVkID0gY2hlY2suY2hlY2tlZDtcblx0XHRcdHByb2plY3RMb2dpYy5zYXZlUHJvamVjdChwcm9qZWN0TG9naWMucHJvamVjdExpc3QpO1xuXHRcdH0pO1xuXG5cdFx0Y2hlY2suY2hlY2tlZCA9IG9iai5jb21wbGV0ZWQ7XG5cblx0XHRpZiAob2JqLnByaW9yaXR5ID09PSBcIkhpZ2hcIilcblx0XHRcdGNoZWNrU3Bhbi5zdHlsZS5jc3NUZXh0ID0gXCJib3JkZXItY29sb3I6IHJlZDsgLS1jaGVja0NvbG9yOiByZWRcIjtcblx0XHRpZiAob2JqLnByaW9yaXR5ID09PSBcIk1lZGl1bVwiKVxuXHRcdFx0Y2hlY2tTcGFuLnN0eWxlLmNzc1RleHQgPSBcImJvcmRlci1jb2xvcjogb3JhbmdlOyAtLWNoZWNrQ29sb3I6IG9yYW5nZVwiO1xuXHRcdGlmIChvYmoucHJpb3JpdHkgPT09IFwiTG93XCIpXG5cdFx0XHRjaGVja1NwYW4uc3R5bGUuY3NzVGV4dCA9IFwiYm9yZGVyLWNvbG9yOiBncmVlbjsgLS1jaGVja0NvbG9yOiBncmVlblwiO1xuXG5cdFx0Y2hlY2tMYWJlbC5hcHBlbmRDaGlsZChjaGVjayk7XG5cdFx0Y2hlY2tMYWJlbC5hcHBlbmRDaGlsZChjaGVja1NwYW4pO1xuXHRcdGNoZWNrU3Bhbi5jbGFzc0xpc3QuYWRkKFwiY3VzdG9tLWNoZWNrYm94XCIpO1xuXHRcdHRvZG9UZXh0LmFwcGVuZENoaWxkKHRvZG9OYW1lKTtcblx0XHR0b2RvVGV4dC5hcHBlbmRDaGlsZCh0b2RvRGVzY3JpcHRpb24pO1xuXHRcdGxlZnRDb250YWluZXIuYXBwZW5kQ2hpbGQoY2hlY2tMYWJlbCk7XG5cdFx0bGVmdENvbnRhaW5lci5hcHBlbmRDaGlsZCh0b2RvVGV4dCk7XG5cdFx0cmlnaHRDb250YWluZXIuYXBwZW5kQ2hpbGQodG9kb0RhdGUpO1xuXHRcdHJpZ2h0Q29udGFpbmVyLmFwcGVuZENoaWxkKGVkaXQpO1xuXHRcdHJpZ2h0Q29udGFpbmVyLmFwcGVuZENoaWxkKGRlbCk7XG5cdFx0Ly8gdG9kb0NvbnRhaW5lci5hcHBlbmRDaGlsZChjaGVjayk7XG5cdFx0dG9kb0NvbnRhaW5lci5hcHBlbmRDaGlsZChsZWZ0Q29udGFpbmVyKTtcblx0XHQvLyB0b2RvQ29udGFpbmVyLmFwcGVuZENoaWxkKHRvZG9UZXh0KTtcblx0XHR0b2RvQ29udGFpbmVyLmFwcGVuZENoaWxkKHJpZ2h0Q29udGFpbmVyKTtcblxuXHRcdGNvbnRlbnQuYXBwZW5kQ2hpbGQodG9kb0NvbnRhaW5lcik7XG5cdH1cblxuXHRmdW5jdGlvbiBlZGl0VG9kbyhpKSB7XG5cdFx0bGV0IGxpc3QgPSBwcm9qZWN0TG9naWMucHJvamVjdExpc3RbdG9kb0xvZ2ljLmlzU2VsZWN0ZWQoKV0udG9kb19saXN0O1xuXHRcdGNvbnN0IHRvZG9OYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvLW5hbWVcIik7XG5cdFx0Y29uc3QgdG9kb0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvLWRlc2NyaXB0aW9uXCIpO1xuXHRcdGNvbnN0IHRvZG9EYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvLWRhdGVcIik7XG5cdFx0Y29uc3QgdG9kb1ByaW9yaXR5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmlvcml0eVwiKTtcblxuXHRcdHRvZG9OYW1lLnZhbHVlID0gbGlzdFtpXS50b2RvTmFtZTtcblx0XHR0b2RvRGVzY3JpcHRpb24udmFsdWUgPSBsaXN0W2ldLmRlc2NyaXB0aW9uO1xuXHRcdHRvZG9EYXRlLnZhbHVlID0gbGlzdFtpXS5kYXRlO1xuXHRcdHRvZG9Qcmlvcml0eS52YWx1ZSA9IGxpc3RbaV0ucHJpb3JpdHk7XG5cdFx0dG9nZ2xlTW9kYWwoKTtcblxuXHRcdG1vZGFsRm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIG1vZGFsRmxvdyk7XG5cblx0XHRtb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiB0b2RvRWRpdEZvcm0oKSB7XG5cdFx0XHRsaXN0W2ldLnRvZG9OYW1lID0gdG9kb05hbWUudmFsdWU7XG5cdFx0XHRsaXN0W2ldLmRlc2NyaXB0aW9uID0gdG9kb0Rlc2NyaXB0aW9uLnZhbHVlO1xuXHRcdFx0bGlzdFtpXS5kYXRlID0gdG9kb0RhdGUudmFsdWU7XG5cdFx0XHRsaXN0W2ldLnByaW9yaXR5ID0gdG9kb1ByaW9yaXR5LnZhbHVlO1xuXHRcdFx0bGV0IGluZGV4ID0gdG9kb0xvZ2ljLmlzU2VsZWN0ZWQoKTtcblx0XHRcdHByb2plY3RMb2dpYy5wcm9qZWN0TGlzdFtpbmRleF0udG9kb19saXN0ID0gdG9kb0xvZ2ljLnNvcnRMaXN0KFxuXHRcdFx0XHRwcm9qZWN0TG9naWMucHJvamVjdExpc3RbaW5kZXhdLnRvZG9fbGlzdFxuXHRcdFx0KTtcblx0XHRcdGNsZWFyVG9kbygpO1xuXHRcdFx0ZGlzcGxheVRvZG8oKTtcblx0XHRcdHRvZ2dsZU1vZGFsKCk7XG5cdFx0XHR0b2RvTmFtZS52YWx1ZSA9IFwiXCI7XG5cdFx0XHR0b2RvRGVzY3JpcHRpb24udmFsdWUgPSBcIlwiO1xuXHRcdFx0dG9kb0RhdGUudmFsdWUgPSBcIlwiO1xuXHRcdFx0dG9kb1ByaW9yaXR5LnZhbHVlID0gXCJMb3dcIjtcblx0XHRcdHByb2plY3RMb2dpYy5zYXZlUHJvamVjdChwcm9qZWN0TG9naWMucHJvamVjdExpc3QpO1xuXHRcdFx0dGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRvZG9FZGl0Rm9ybSk7XG5cdFx0XHRtb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBtb2RhbEZsb3cpO1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gZGVsZXRlVG9kbyhpKSB7XG5cdFx0bGV0IGxpc3QgPSBwcm9qZWN0TG9naWMucHJvamVjdExpc3RbdG9kb0xvZ2ljLmlzU2VsZWN0ZWQoKV0udG9kb19saXN0O1xuXHRcdGxpc3Quc3BsaWNlKGksIDEpO1xuXHRcdHByb2plY3RMb2dpYy5zYXZlUHJvamVjdChwcm9qZWN0TG9naWMucHJvamVjdExpc3QpO1xuXHRcdGRpc3BsYXlUb2RvKCk7XG5cdH1cblxuXHRyZXR1cm4geyBhZGRUb2RvQnV0dG9uLCByZW1vdmVUb2RvQnV0dG9uLCBkaXNwbGF5VG9kbyB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgdG9kb0RPTTtcbiIsImltcG9ydCBwcm9qZWN0TG9naWMgZnJvbSBcIi4vcHJvamVjdC1sb2dpYy5qc1wiO1xuaW1wb3J0IHRvZG9Mb2dpYyBmcm9tIFwiLi90b2RvLWxvZ2ljLmpzXCI7XG5pbXBvcnQgdG9kb0RPTSBmcm9tIFwiLi90b2RvLWRvbS5qc1wiO1xuXG5jb25zdCBwcm9qZWN0RE9NID0gKCgpID0+IHtcblx0Y29uc3QgcHJvamVjdENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvamVjdHMtY29udGFpbmVyXCIpO1xuXHRjb25zdCBwcm9qZWN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLXByb2plY3RcIik7XG5cblx0cHJvamVjdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRjb25zdCBwcm9qZWN0VGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1uYW1lXCIpO1xuXHRcdGFkZFByb2plY3RUb0FycmF5KHByb2plY3RUZXh0LnZhbHVlKTtcblx0XHRyZW5kZXIoKTtcblx0XHRwcm9qZWN0VGV4dC52YWx1ZSA9IFwiXCI7XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGFkZFByb2plY3QoaW5wdXROYW1lLCBpKSB7XG5cdFx0Y29uc3QgcHJvamVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0Y29uc3QgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdGNvbnN0IGVkaXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuXHRcdGNvbnN0IGRlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cblx0XHRwcm9qZWN0LmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0XCIpO1xuXHRcdHByb2plY3ROYW1lLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXRpdGxlXCIpO1xuXHRcdGVkaXQuY2xhc3NMaXN0LmFkZChcImJ0blwiKTtcblx0XHRkZWwuY2xhc3NMaXN0LmFkZChcImJ0blwiKTtcblx0XHRlZGl0LnRleHRDb250ZW50ID0gXCJFXCI7XG5cdFx0ZGVsLnRleHRDb250ZW50ID0gXCJYXCI7XG5cblx0XHRwcm9qZWN0TmFtZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRkZXNlbGVjdFByb2plY3QoKTtcblx0XHRcdHByb2plY3RMb2dpYy5zZWxlY3QoaSwgdHJ1ZSk7XG5cdFx0XHRyZW5kZXIoKTtcblx0XHR9KTtcblxuXHRcdGVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0ZWRpdFByb2plY3QoaSk7XG5cdFx0fSk7XG5cblx0XHRkZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0ZGVsZXRlUHJvamVjdChpKTtcblx0XHR9KTtcblxuXHRcdHByb2plY3ROYW1lLnRleHRDb250ZW50ID0gaW5wdXROYW1lO1xuXG5cdFx0cHJvamVjdC5hcHBlbmRDaGlsZChwcm9qZWN0TmFtZSk7XG5cdFx0cHJvamVjdC5hcHBlbmRDaGlsZChlZGl0KTtcblx0XHRwcm9qZWN0LmFwcGVuZENoaWxkKGRlbCk7XG5cblx0XHRwcm9qZWN0Q29udGFpbmVyLmFwcGVuZENoaWxkKHByb2plY3QpO1xuXHR9XG5cblx0ZnVuY3Rpb24gcmVuZGVyKCkge1xuXHRcdGNsZWFyUHJvamVjdCgpO1xuXHRcdGxldCBpID0gMDtcblx0XHRsZXQgbGlzdCA9IHByb2plY3RMb2dpYy5wcm9qZWN0TGlzdDtcblx0XHRjb25zb2xlLmxvZyhsaXN0KTtcblx0XHRmb3IgKGk7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRhZGRQcm9qZWN0KGxpc3RbaV0ucHJvamVjdE5hbWUsIGkpO1xuXHRcdFx0aWYgKGxpc3RbaV0uc2VsZWN0ZWQgPT09IHRydWUpIHtcblx0XHRcdFx0c2VsZWN0UHJvamVjdChpKTtcblx0XHRcdFx0dG9kb0RPTS5hZGRUb2RvQnV0dG9uKCk7XG5cdFx0XHRcdHRvZG9ET00uZGlzcGxheVRvZG8oKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBjbGVhclByb2plY3QoKSB7XG5cdFx0d2hpbGUgKHByb2plY3RDb250YWluZXIuZmlyc3RDaGlsZCkge1xuXHRcdFx0cHJvamVjdENvbnRhaW5lci5yZW1vdmVDaGlsZChwcm9qZWN0Q29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGFkZFByb2plY3RUb0FycmF5KHByb2plY3ROYW1lKSB7XG5cdFx0cHJvamVjdExvZ2ljLm1ha2VQcm9qZWN0KHByb2plY3ROYW1lLCBbXSk7XG5cdH1cblxuXHRmdW5jdGlvbiBkZWxldGVQcm9qZWN0KGkpIHtcblx0XHRjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcm9qZWN0XCIpO1xuXHRcdHByb2plY3RDb250YWluZXIucmVtb3ZlQ2hpbGQocHJvamVjdFtpXSk7XG5cdFx0cHJvamVjdExvZ2ljLnJlbW92ZVByb2plY3QoaSk7XG5cdFx0cmVuZGVyKCk7XG5cdFx0Y29uc29sZS5sb2codG9kb0xvZ2ljLmlzU2VsZWN0ZWQoKSk7XG5cdH1cblxuXHRmdW5jdGlvbiBlZGl0UHJvamVjdChpKSB7XG5cdFx0Y29uc3QgcHJvamVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdFwiKTtcblx0XHRjb25zdCBwcm9qZWN0VGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb2plY3QtdGl0bGVcIik7XG5cdFx0Y29uc3QgZWRpdFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG5cdFx0ZWRpdFRleHQuY2xhc3NMaXN0LmFkZChcImVkaXQtdGV4dFwiKTtcblx0XHRlZGl0VGV4dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidGV4dFwiKTtcblx0XHRlZGl0VGV4dC5zZXRBdHRyaWJ1dGUoXCJtYXhsZW5ndGhcIiwgXCIxMFwiKTtcblx0XHRlZGl0VGV4dC52YWx1ZSA9IHByb2plY3RMb2dpYy5wcm9qZWN0TGlzdFtpXS5wcm9qZWN0TmFtZTtcblx0XHRwcm9qZWN0W2ldLnJlbW92ZUNoaWxkKHByb2plY3RUaXRsZVtpXSk7XG5cdFx0cHJvamVjdFtpXS5hcHBlbmRDaGlsZChlZGl0VGV4dCk7XG5cdFx0ZWRpdFRleHQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXByZXNzXCIsIChlKSA9PiB7XG5cdFx0XHRpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcInllc1wiKTtcblx0XHRcdFx0cHJvamVjdExvZ2ljLmNoYW5nZU5hbWUoZWRpdFRleHQudmFsdWUsIGkpO1xuXHRcdFx0XHRyZW5kZXIoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHNlbGVjdFByb2plY3QoaSkge1xuXHRcdGRlc2VsZWN0UHJvamVjdCgpO1xuXHRcdHByb2plY3RMb2dpYy5zZWxlY3QoaSwgdHJ1ZSk7XG5cdFx0Y29uc3QgcHJvamVjdFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcm9qZWN0LXRpdGxlXCIpO1xuXHRcdHByb2plY3RUaXRsZVtpXS5zdHlsZS5jc3NUZXh0ID0gXCJmb250LXdlaWdodDogYm9sZFwiO1xuXHR9XG5cblx0ZnVuY3Rpb24gZGVzZWxlY3RQcm9qZWN0KCkge1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcHJvamVjdExvZ2ljLnByb2plY3RMaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRwcm9qZWN0TG9naWMuc2VsZWN0KGksIGZhbHNlKTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4geyBhZGRQcm9qZWN0LCByZW5kZXIgfTtcbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IHByb2plY3RET007XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB0ZXN0KCkge1xuXHRjb25zb2xlLmxvZyhcInRlc3RcIik7XG59XG4iLCJpbXBvcnQgdGVzdCBmcm9tIFwiLi90ZXN0LmpzXCI7XG5pbXBvcnQgcHJvamVjdExvZ2ljIGZyb20gXCIuL3Byb2plY3QtbG9naWMuanNcIjtcbmltcG9ydCBwcm9qZWN0RE9NIGZyb20gXCIuL3Byb2plY3QtZG9tLmpzXCI7XG5pbXBvcnQgdG9kb0xvZ2ljIGZyb20gXCIuL3RvZG8tbG9naWMuanNcIjtcblxudGVzdCgpO1xucHJvamVjdERPTS5yZW5kZXIoKTtcbnByb2plY3RET007XG4iXSwic291cmNlUm9vdCI6IiJ9